<!doctype html><html lang=fr dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Kerberoasting : Attaque d'Active Directory via Kerberos | larass0x04</title><meta name=keywords content="Active Directory,blog,Kerberos,attaques,pentest"><meta name=description content="Une attaque redoutable post-exploitation qui cible les services Kerberos dans les environnements Active Directory. D√©cryptons ensemble la m√©thode, les outils et les moyens de d√©fense."><meta name=author content="Michel NYOBE"><link rel=canonical href=https://nyobemichel.me/posts/kerberoasting/><link crossorigin=anonymous href=/assets/css/stylesheet.93f625d739f1d6a5c6f20c146bc6a8d26b233492b34b2220c54b12fd46a04ded.css integrity="sha256-k/Yl1znx1qXG8gwUa8ao0msjNJKzSyIgxUsS/UagTe0=" rel="preload stylesheet" as=style><link rel=icon href=https://nyobemichel.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nyobemichel.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nyobemichel.me/favicon-32x32.png><link rel=apple-touch-icon href=https://nyobemichel.me/apple-touch-icon.png><link rel=mask-icon href=https://nyobemichel.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=fr href=https://nyobemichel.me/posts/kerberoasting/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-S1YCLX5573"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S1YCLX5573")}</script><meta property="og:url" content="https://nyobemichel.me/posts/kerberoasting/"><meta property="og:site_name" content="larass0x04"><meta property="og:title" content="Kerberoasting : Attaque d'Active Directory via Kerberos"><meta property="og:description" content="Une attaque redoutable post-exploitation qui cible les services Kerberos dans les environnements Active Directory. D√©cryptons ensemble la m√©thode, les outils et les moyens de d√©fense."><meta property="og:locale" content="fr"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-05T19:00:00+02:00"><meta property="article:modified_time" content="2025-05-05T19:00:00+02:00"><meta property="article:tag" content="Active Directory"><meta property="article:tag" content="Blog"><meta property="article:tag" content="Kerberos"><meta property="article:tag" content="Attaques"><meta property="article:tag" content="Pentest"><meta property="og:image" content="https://nyobemichel.me/images/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nyobemichel.me/images/papermod-cover.png"><meta name=twitter:title content="Kerberoasting : Attaque d'Active Directory via Kerberos"><meta name=twitter:description content="Une attaque redoutable post-exploitation qui cible les services Kerberos dans les environnements Active Directory. D√©cryptons ensemble la m√©thode, les outils et les moyens de d√©fense."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://nyobemichel.me/posts/"},{"@type":"ListItem","position":2,"name":"Kerberoasting : Attaque d'Active Directory via Kerberos","item":"https://nyobemichel.me/posts/kerberoasting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Kerberoasting : Attaque d'Active Directory via Kerberos","name":"Kerberoasting : Attaque d\u0027Active Directory via Kerberos","description":"Une attaque redoutable post-exploitation qui cible les services Kerberos dans les environnements Active Directory. D√©cryptons ensemble la m√©thode, les outils et les moyens de d√©fense.","keywords":["Active Directory","blog","Kerberos","attaques","pentest"],"articleBody":"Introduction Kerberoasting est une technique d‚Äôattaque post-exploitation qui cible les environnements Active Directory, plus pr√©cis√©ment les comptes de service prot√©g√©s par le protocole d‚Äôauthentification Kerberos.\nL‚Äôobjectif de l‚Äôattaquant est de r√©cup√©rer des tickets de service (TGS) chiffr√©s, puis de craquer hors ligne les hashs de mots de passe des comptes de service associ√©s √† des Service Principal Names (SPN). Une fois le mot de passe r√©cup√©r√©, cela peut mener √† une √©l√©vation de privil√®ges ou √† une lateralisation dans le r√©seau.\n‚öôÔ∏è Fonctionnement du protocole Kerberos (rappel rapide) Lorsqu‚Äôun utilisateur demande l‚Äôacc√®s √† un service, il envoie un TGT (Ticket Granting Ticket) valide et le nom du service (via le sname) au KDC (Key Distribution Center). Si le ticket est valide, le KDC renvoie un TGS, chiffr√© avec le hash du mot de passe du compte de service cibl√©.\nC‚Äôest cette √©tape que l‚Äôattaquant va d√©tourner pour capturer ce TGS et tenter de retrouver le mot de passe par brute force ou dictionnaire.\nüß† √âtapes de l‚Äôattaque Kerberoasting Voici le workflow typique d‚Äôune attaque Kerberoasting :\n1. Acc√®s initial L‚Äôattaquant compromet un compte d‚Äôutilisateur standard dans le domaine Active Directory.\n2. Reconnaissance Il utilise des outils pour √©num√©rer les SPN pr√©sents dans le domaine (comptes de service).\n3. Requ√™te TGS Il envoie des requ√™tes au contr√¥leur de domaine pour obtenir les tickets TGS associ√©s √† ces SPN.\n4. Extraction de tickets Il extrait les TGS localement (le syst√®me les stocke en m√©moire), √† l‚Äôaide d‚Äôoutils comme Rubeus ou Mimikatz.\n5. Crackage hors ligne Le ticket est crack√© hors ligne avec Hashcat ou John the Ripper afin de r√©v√©ler le mot de passe du compte de service.\nüîß Outils utiles Voici une liste d‚Äôoutils populaires pour mener une attaque Kerberoasting :\nRubeus (C#) Mimikatz Impacket - GetUserSPNs.py PowerView (PowerShell) Empire / Invoke-Kerberoast.ps1 Hashcat ou John pour le crackage hors ligne üí• Ex√©cution de l‚Äôattaque - Cas pratiques üéØ Kerberoasting avec Rubeus Rubeus.exe kerberoast üí£ Cracker le hash avec Hashcat hashcat -m 13100 -a 0 hash.txt wordlist.txt üêç Kerberoasting avec Impacket (GetUserSPNs.py) Lister les comptes SPN :\nGetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend Extraire le TGS chiffr√© :\nsudo python3 GetUserSPNs.py controller.local/Machine1:Password1 -dc-ip 10.10.3.141 -request ‚ö° Kerberoasting avec PowerView Importer PowerView :\nImport-Module .\\PowerView.ps1 Lister les utilisateurs avec SPN :\nGet-DomainUser * -SPN | select samaccountname Extraire un TGS au format Hashcat :\nGet-DomainUser -Identity sqldev | Get-DomainSPNTicket -Format Hashcat Exporter tous les tickets vers un fichier CSV:\nGet-DomainUser * -SPN | Get-DomainSPNTicket -Format Hashcat | Export-Csv .\\tickets.csv -NoTypeInformation üß≠ Contextes d‚Äôex√©cution possibles Une attaque Kerberoasting peut √™tre lanc√©e √† partir de diff√©rents environnements :\nüíª Windows joint au domaine, avec un shell utilisateur ou SYSTEM üêß Linux joint ou non au domaine, avec keytab ou identifiants üîê Shell distant avec runas /netonly sur Windows üß™ Via un acc√®s VPN ou une session RDP, avec des outils de pentest üõ°Ô∏è D√©tection \u0026 d√©fense Pour se d√©fendre contre Kerberoasting, voici quelques bonnes pratiques :\nUtiliser des mots de passe robustes et complexes pour les comptes de service √âviter les comptes de service √† privil√®ges √©lev√©s (comme Domain Admin) Impl√©menter Managed Service Accounts (MSA/gMSA) Surveiller les requ√™tes TGS en masse D√©ployer des solutions de d√©tection comportementale (EDR, SIEM, etc.) Restreindre les permissions des utilisateurs standards üìö R√©f√©rences utiles Rubeus GitHub Impacket Tools PowerView Kerberoasting Technique (MITRE ATT\u0026CK) ","wordCount":"551","inLanguage":"fr","image":"https://nyobemichel.me/images/papermod-cover.png","datePublished":"2025-05-05T19:00:00+02:00","dateModified":"2025-05-05T19:00:00+02:00","author":{"@type":"Person","name":"Michel NYOBE"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nyobemichel.me/posts/kerberoasting/"},"publisher":{"@type":"Organization","name":"larass0x04","logo":{"@type":"ImageObject","url":"https://nyobemichel.me/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://nyobemichel.me/ accesskey=h title="larass0x04 (Alt + H)">larass0x04</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://nyobemichel.me/about title=Moi><span>Moi</span></a></li><li><a href=https://nyobemichel.me/posts/ title=Articles><span>Articles</span></a></li><li><a href=https://nyobemichel.me/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://nyobemichel.me/categories title=Categories><span>Categories</span></a></li><li><a href=https://nyobemichel.me/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://nyobemichel.me/>Accueil</a>&nbsp;¬ª&nbsp;<a href=https://nyobemichel.me/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Kerberoasting : Attaque d'Active Directory via Kerberos</h1><div class=post-meta><span title='2025-05-05 19:00:00 +0200 +0200'>mai 5, 2025</span>&nbsp;¬∑&nbsp;3 min&nbsp;¬∑&nbsp;Michel NYOBE</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table des mati√®res</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#-fonctionnement-du-protocole-kerberos-rappel-rapide aria-label="‚öôÔ∏è Fonctionnement du protocole Kerberos (rappel rapide)">‚öôÔ∏è Fonctionnement du protocole Kerberos (rappel rapide)</a></li><li><a href=#-%c3%a9tapes-de-lattaque-kerberoasting aria-label="üß† √âtapes de l‚Äôattaque Kerberoasting">üß† √âtapes de l‚Äôattaque Kerberoasting</a><ul><li><a href=#1-acc%c3%a8s-initial aria-label="1. Acc√®s initial">1. Acc√®s initial</a></li><li><a href=#2-reconnaissance aria-label="2. Reconnaissance">2. Reconnaissance</a></li><li><a href=#3-requ%c3%aate-tgs aria-label="3. Requ√™te TGS">3. Requ√™te TGS</a></li><li><a href=#4-extraction-de-tickets aria-label="4. Extraction de tickets">4. Extraction de tickets</a></li><li><a href=#5-crackage-hors-ligne aria-label="5. Crackage hors ligne">5. Crackage hors ligne</a></li></ul></li><li><a href=#-outils-utiles aria-label="üîß Outils utiles">üîß Outils utiles</a></li><li><a href=#-ex%c3%a9cution-de-lattaque---cas-pratiques aria-label="üí• Ex√©cution de l‚Äôattaque - Cas pratiques">üí• Ex√©cution de l‚Äôattaque - Cas pratiques</a><ul><li><a href=#-kerberoasting-avec-rubeus aria-label="üéØ Kerberoasting avec Rubeus">üéØ Kerberoasting avec Rubeus</a></li><li><a href=#-cracker-le-hash-avec-hashcat aria-label="üí£ Cracker le hash avec Hashcat">üí£ Cracker le hash avec Hashcat</a></li><li><a href=#-kerberoasting-avec-impacket-getuserspnspy aria-label="üêç Kerberoasting avec Impacket (GetUserSPNs.py)">üêç Kerberoasting avec Impacket (GetUserSPNs.py)</a></li><li><a href=#-kerberoasting-avec-powerview aria-label="‚ö° Kerberoasting avec PowerView">‚ö° Kerberoasting avec PowerView</a></li></ul></li><li><a href=#-contextes-dex%c3%a9cution-possibles aria-label="üß≠ Contextes d‚Äôex√©cution possibles">üß≠ Contextes d‚Äôex√©cution possibles</a></li><li><a href=#-d%c3%a9tection--d%c3%a9fense aria-label="üõ°Ô∏è D√©tection & d√©fense">üõ°Ô∏è D√©tection & d√©fense</a></li><li><a href=#-r%c3%a9f%c3%a9rences-utiles aria-label="üìö R√©f√©rences utiles">üìö R√©f√©rences utiles</a></li></ul></div></details></div><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p><strong>Kerberoasting</strong> est une technique d‚Äôattaque post-exploitation qui cible les environnements <strong>Active Directory</strong>, plus pr√©cis√©ment les <strong>comptes de service</strong> prot√©g√©s par le protocole d‚Äôauthentification <strong>Kerberos</strong>.</p><p>L‚Äôobjectif de l‚Äôattaquant est de r√©cup√©rer des <strong>tickets de service (TGS)</strong> chiffr√©s, puis de <strong>craquer hors ligne</strong> les <strong>hashs</strong> de mots de passe des comptes de service associ√©s √† des <strong>Service Principal Names (SPN)</strong>. Une fois le mot de passe r√©cup√©r√©, cela peut mener √† une <strong>√©l√©vation de privil√®ges</strong> ou √† une <strong>lateralisation dans le r√©seau</strong>.</p><hr><h2 id=-fonctionnement-du-protocole-kerberos-rappel-rapide>‚öôÔ∏è Fonctionnement du protocole Kerberos (rappel rapide)<a hidden class=anchor aria-hidden=true href=#-fonctionnement-du-protocole-kerberos-rappel-rapide>#</a></h2><p>Lorsqu‚Äôun utilisateur demande l‚Äôacc√®s √† un service, il envoie un <strong>TGT (Ticket Granting Ticket)</strong> valide et le nom du service (via le <code>sname</code>) au <strong>KDC (Key Distribution Center)</strong>. Si le ticket est valide, le KDC renvoie un <strong>TGS</strong>, chiffr√© avec le hash du mot de passe du compte de service cibl√©.</p><p>C‚Äôest cette √©tape que l‚Äôattaquant va d√©tourner pour capturer ce TGS et tenter de retrouver le mot de passe par <strong>brute force ou dictionnaire</strong>.</p><hr><h2 id=-√©tapes-de-lattaque-kerberoasting>üß† √âtapes de l‚Äôattaque Kerberoasting<a hidden class=anchor aria-hidden=true href=#-√©tapes-de-lattaque-kerberoasting>#</a></h2><p>Voici le <strong>workflow typique</strong> d‚Äôune attaque Kerberoasting :</p><h3 id=1-acc√®s-initial>1. Acc√®s initial<a hidden class=anchor aria-hidden=true href=#1-acc√®s-initial>#</a></h3><p>L‚Äôattaquant compromet un <strong>compte d‚Äôutilisateur standard</strong> dans le domaine Active Directory.</p><h3 id=2-reconnaissance>2. Reconnaissance<a hidden class=anchor aria-hidden=true href=#2-reconnaissance>#</a></h3><p>Il utilise des outils pour <strong>√©num√©rer les SPN</strong> pr√©sents dans le domaine (comptes de service).</p><h3 id=3-requ√™te-tgs>3. Requ√™te TGS<a hidden class=anchor aria-hidden=true href=#3-requ√™te-tgs>#</a></h3><p>Il envoie des requ√™tes au <strong>contr√¥leur de domaine</strong> pour obtenir les tickets TGS associ√©s √† ces SPN.</p><h3 id=4-extraction-de-tickets>4. Extraction de tickets<a hidden class=anchor aria-hidden=true href=#4-extraction-de-tickets>#</a></h3><p>Il extrait les TGS <strong>localement</strong> (le syst√®me les stocke en m√©moire), √† l‚Äôaide d‚Äôoutils comme <strong>Rubeus</strong> ou <strong>Mimikatz</strong>.</p><h3 id=5-crackage-hors-ligne>5. Crackage hors ligne<a hidden class=anchor aria-hidden=true href=#5-crackage-hors-ligne>#</a></h3><p>Le ticket est crack√© hors ligne avec <strong>Hashcat</strong> ou <strong>John the Ripper</strong> afin de r√©v√©ler le <strong>mot de passe du compte de service</strong>.</p><hr><h2 id=-outils-utiles>üîß Outils utiles<a hidden class=anchor aria-hidden=true href=#-outils-utiles>#</a></h2><p>Voici une liste d‚Äôoutils populaires pour mener une attaque Kerberoasting :</p><ul><li><strong><a href=https://github.com/GhostPack/Rubeus>Rubeus</a></strong> (C#)</li><li><strong>Mimikatz</strong></li><li><strong>Impacket - GetUserSPNs.py</strong></li><li><strong>PowerView (PowerShell)</strong></li><li><strong>Empire / Invoke-Kerberoast.ps1</strong></li><li><strong>Hashcat</strong> ou <strong>John</strong> pour le crackage hors ligne</li></ul><hr><h2 id=-ex√©cution-de-lattaque---cas-pratiques>üí• Ex√©cution de l‚Äôattaque - Cas pratiques<a hidden class=anchor aria-hidden=true href=#-ex√©cution-de-lattaque---cas-pratiques>#</a></h2><h3 id=-kerberoasting-avec-rubeus>üéØ Kerberoasting avec Rubeus<a hidden class=anchor aria-hidden=true href=#-kerberoasting-avec-rubeus>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Rubeus.exe kerberoast
</span></span></code></pre></div><h3 id=-cracker-le-hash-avec-hashcat>üí£ Cracker le hash avec Hashcat<a hidden class=anchor aria-hidden=true href=#-cracker-le-hash-avec-hashcat>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hashcat -m <span class=m>13100</span> -a <span class=m>0</span> hash.txt wordlist.txt
</span></span></code></pre></div><hr><h3 id=-kerberoasting-avec-impacket-getuserspnspy>üêç Kerberoasting avec Impacket (GetUserSPNs.py)<a hidden class=anchor aria-hidden=true href=#-kerberoasting-avec-impacket-getuserspnspy>#</a></h3><p>Lister les comptes SPN :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>GetUserSPNs.py -dc-ip 172.16.5.5 INLANEFREIGHT.LOCAL/forend
</span></span></code></pre></div><p>Extraire le TGS chiffr√© :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo python3 GetUserSPNs.py controller.local/Machine1:Password1 -dc-ip 10.10.3.141 -request
</span></span></code></pre></div><hr><h3 id=-kerberoasting-avec-powerview>‚ö° Kerberoasting avec PowerView<a hidden class=anchor aria-hidden=true href=#-kerberoasting-avec-powerview>#</a></h3><p>Importer PowerView :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Import-Module</span> <span class=p>.\</span><span class=n>PowerView</span><span class=p>.</span><span class=py>ps1</span>
</span></span></code></pre></div><p>Lister les utilisateurs avec SPN :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-DomainUser</span> <span class=p>*</span> <span class=n>-SPN</span> <span class=p>|</span> <span class=nb>select </span><span class=n>samaccountname</span>
</span></span></code></pre></div><p>Extraire un TGS au format Hashcat :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-DomainUser</span> <span class=n>-Identity</span> <span class=n>sqldev</span> <span class=p>|</span> <span class=nb>Get-DomainSPNTicket</span> <span class=n>-Format</span> <span class=n>Hashcat</span>
</span></span></code></pre></div><p>Exporter tous les tickets vers un fichier CSV:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Get-DomainUser</span> <span class=p>*</span> <span class=n>-SPN</span> <span class=p>|</span> <span class=nb>Get-DomainSPNTicket</span> <span class=n>-Format</span> <span class=n>Hashcat</span> <span class=p>|</span> <span class=nb>Export-Csv</span> <span class=p>.\</span><span class=n>tickets</span><span class=p>.</span><span class=py>csv</span> <span class=n>-NoTypeInformation</span>
</span></span></code></pre></div><hr><h2 id=-contextes-dex√©cution-possibles>üß≠ Contextes d‚Äôex√©cution possibles<a hidden class=anchor aria-hidden=true href=#-contextes-dex√©cution-possibles>#</a></h2><p>Une attaque Kerberoasting peut √™tre lanc√©e √† partir de diff√©rents environnements :</p><ul><li>üíª <strong>Windows joint au domaine</strong>, avec un shell utilisateur ou SYSTEM</li><li>üêß <strong>Linux joint ou non au domaine</strong>, avec keytab ou identifiants</li><li>üîê <strong>Shell distant avec <code>runas /netonly</code></strong> sur Windows</li><li>üß™ <strong>Via un acc√®s VPN ou une session RDP</strong>, avec des outils de pentest</li></ul><hr><h2 id=-d√©tection--d√©fense>üõ°Ô∏è D√©tection & d√©fense<a hidden class=anchor aria-hidden=true href=#-d√©tection--d√©fense>#</a></h2><p>Pour <strong>se d√©fendre contre Kerberoasting</strong>, voici quelques bonnes pratiques :</p><ul><li>Utiliser des <strong>mots de passe robustes</strong> et complexes pour les comptes de service</li><li>√âviter les comptes de service √† privil√®ges √©lev√©s (comme <code>Domain Admin</code>)</li><li>Impl√©menter <strong>Managed Service Accounts (MSA/gMSA)</strong></li><li>Surveiller les <strong>requ√™tes TGS en masse</strong></li><li>D√©ployer des solutions de <strong>d√©tection comportementale (EDR, SIEM, etc.)</strong></li><li>Restreindre les permissions des utilisateurs standards</li></ul><hr><h2 id=-r√©f√©rences-utiles>üìö R√©f√©rences utiles<a hidden class=anchor aria-hidden=true href=#-r√©f√©rences-utiles>#</a></h2><ul><li><a href=https://github.com/GhostPack/Rubeus>Rubeus GitHub</a></li><li><a href=https://github.com/SecureAuthCorp/impacket>Impacket Tools</a></li><li><a href=https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon>PowerView</a></li><li><a href=https://attack.mitre.org/techniques/T1558/003/>Kerberoasting Technique (MITRE ATT&amp;CK)</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://nyobemichel.me/tags/active-directory/>Active Directory</a></li><li><a href=https://nyobemichel.me/tags/blog/>Blog</a></li><li><a href=https://nyobemichel.me/tags/kerberos/>Kerberos</a></li><li><a href=https://nyobemichel.me/tags/attaques/>Attaques</a></li><li><a href=https://nyobemichel.me/tags/pentest/>Pentest</a></li></ul><nav class=paginav><a class=prev href=https://nyobemichel.me/posts/publisher-thm/><span class=title>¬´ Pr√©c√©dent</span><br><span>Publisher - THM</span>
</a><a class=next href=https://nyobemichel.me/posts/sid--identificateurs-de-s%C3%A9curit%C3%A9-/><span class=title>Suivant ¬ª</span><br><span>SID ( Identificateurs de s√©curit√© )</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on x" href="https://x.com/intent/tweet/?text=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos&amp;url=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f&amp;hashtags=ActiveDirectory%2cblog%2cKerberos%2cattaques%2cpentest"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f&amp;title=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos&amp;summary=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos&amp;source=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f&title=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on whatsapp" href="https://api.whatsapp.com/send?text=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos%20-%20https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on telegram" href="https://telegram.me/share/url?text=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos&amp;url=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Kerberoasting : Attaque d'Active Directory via Kerberos on ycombinator" href="https://news.ycombinator.com/submitlink?t=Kerberoasting%20%3a%20Attaque%20d%27Active%20Directory%20via%20Kerberos&u=https%3a%2f%2fnyobemichel.me%2fposts%2fkerberoasting%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copier";function s(){t.innerHTML="Copi√© !",setTimeout(()=>{t.innerHTML="Copier"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>